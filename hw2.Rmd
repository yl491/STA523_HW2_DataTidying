Homework 2 - [Your team name here]
========================================================

### Task 0 - Load the data

```{r message = FALSE}
library(dplyr)
library(purrr)
library(tibble)
library(repurrrsive)
library(stringr)

load("lego_sales.RData")
```


### Task 1 - Tidying the data

<!-- Covert the `sales` object into a tidy data frame. Be sure to include a write up of your methods. -->

```{r}
d=data_frame(
first_name=map_chr(sales,"first_name"),
last_name=map_chr(sales,"last_name"),
gender=map_chr(sales,"gender"),
age=map_dbl(sales,"age")
)
colnames(final)=cbind("fname","lname","gender","age")
#list_cols = map(sales, ~ map_int(., length) )  %>% 
   #  map(~ which(. > 1)) %>% 
  #   unlist() %>% 
  #   names() %>% 
  #   unique()
#d=map_df(
#     sales[1:3], 
#     function(row)
#     {
#         map_if(row, function(x) length(x) > 1, list)
#     }
 #) %>% View()

num_purchases=rep(0,250)
for(i in 1:250)
{
  temp=unlist(sales[i])
  nam=temp[names(temp)=="purchases.Number"]
  num_purchases[i]=length(nam)
}

dd=as.matrix(d)
ii=0;
final<-matrix(nrow=620,ncol=4)
for (j in 1:250)
{
  for(e in 1:num_purchases[j])
  {
    final[ii+e,]=dd[j,]
  }
  ii=ii+num_purchases[j]
}

half2<-matrix(data=NA, nrow=sum(num_purchases),ncol=10)
iii=0
for (w in 1:250)
{
  temp=unlist(sales[w])
  for (ww in 1:num_purchases[w])
  {
    name1=temp[names(temp)=="purchases.SetID"][ww]
    name2=temp[names(temp)=="purchases.Number"][ww]
    name3=temp[names(temp)=="purchases.Theme"][ww]
    name4=temp[names(temp)=="purchases.Subtheme"][ww]
    name5=temp[names(temp)=="purchases.Year"][ww]
    name6=temp[names(temp)=="purchases.Name"][ww]
    name7=temp[names(temp)=="purchases.Pieces"][ww]
    name8=temp[names(temp)=="purchases.USPrice"][ww]
    name9=temp[names(temp)=="purchases.ImageURL"][ww]
    name10=temp[names(temp)=="purchases.Quantity"][ww]
    tempp=cbind(name1,name2,name3,name4,name5,name6,name7,name8,name9,name10)
    half2[iii+ww,]=tempp
  }
  iii=iii+num_purchases[w]
}
colnames(half2)=cbind("purchases.SetID","number","theme","subtheme","year","name","pieces","usprice","imageurl","quantity")
kkk=cbind(final,half2)
kkkk=as.data.frame(kkk)
  
```


<br/>

## Task 2 - Processing the data


1. What was the most common first name of purchasers? Last name?

```{r}
```

2. What are the five most popular lego sets based on these data?

```{r}
```

3. Which five customers have spent the most money so far and how much have they spent?

```{r}
```

4. Which lego theme has made the most money for lego?

```{r}
```

5. Do men or women buy more lego sets (per person) on average?

```{r}
```

6. What are the five most popular hobbies of lego purchasers?

```{r}
```

7. How many total pieces have been purchased from lego by these customers?

```{r}
```

8. Which area code has spent the most money on legos?

```{r}
```
